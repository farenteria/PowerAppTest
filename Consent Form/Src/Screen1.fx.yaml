Screen1 As screen:
    Fill: =Color.AliceBlue
    OnVisible: |-
        =UpdateContext({BlankImage: Signature.Image})

    Label_ConsentHeader As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =70
        Size: =40
        Text: ="Consent Form"
        Width: =560
        X: =39
        Y: =33
        ZIndex: =1

    Label_Name As label:
        Height: =70
        Size: =21
        Text: ="Name"
        Width: =560
        X: =39
        Y: =103
        ZIndex: =2

    Name As text:
        Default: =""
        Height: =70
        Size: =21
        Width: =560
        X: =39
        Y: =173
        ZIndex: =3

    Label_Email As label:
        Height: =70
        Size: =21
        Text: ="Email"
        Width: =203
        X: =39
        Y: =243
        ZIndex: =4

    EmailAddress As text:
        Color: =If(IsMatch(EmailAddress.Text,Match.Email),Color.Black,Color.Red)
        Default: =""
        DelayOutput: =true
        Height: =70
        OnChange: =
        Size: =21
        Width: =560
        X: =39
        Y: =313
        ZIndex: =5

    Label_Age As label:
        Height: =70
        Size: =21
        Text: |-
            ="Age: " & Slider_Age
        Width: =123
        X: =39
        Y: =383
        ZIndex: =6

    Slider_Age As slider:
        Default: =0
        HandleFill: =If(Slider_Age >= 18,Color.White,Color.Red)
        Height: =70
        ValueFill: =Slider_Age.HandleFill
        Width: =560
        X: =39
        Y: =453
        ZIndex: =7

    Label_Consent As label:
        Height: =70
        Size: =21
        Text: ="Of course you can use my picture."
        Width: =560
        X: =39
        Y: =523
        ZIndex: =8

    Signature As inkControl:
        Fill: =Color.White
        Width: =560
        X: =39
        Y: =593
        ZIndex: =9

    ConsentButton As button:
        DisplayMode: =If(And(BlankImage <> Signature.Image, Slider_Age >= 18, !IsBlank(Name), !IsBlank(EmailAddress)), DisplayMode.Edit, DisplayMode.Disabled)
        Fill: =Color.Black
        Height: =70
        OnSelect: |-
            =Office365Outlook.SendEmail(EmailAddress, "My Subject Text", "Body Text " & Name.Text, {Attachments:Table({Name:"peninput.jpg", ContentBytes:Signature.Image, '@odata.type': ""})});If(Toggle_receive.Value, Office365Outlook.SendEmail(EmailAddress.Text, "Subject", "Thanks for consenting"), false);UpdateContext({Popup: true})
        Size: =24
        Text: ="Consent"
        Width: =280
        X: =39
        Y: =903
        ZIndex: =10

    ResetIcon As icon.Reload:
        Height: =108
        Icon: =Icon.Reload
        OnSelect: |-
            =Reset(Name);Reset(EmailAddress);Reset(Slider_Age);Reset(Signature);UpdateContext({BlankImage: Signature.Image});Reset(Toggle_receive)
        Width: =124
        X: =475
        Y: =884
        ZIndex: =11

    Toggle_receive As toggleSwitch:
        FalseText: ="No"
        Height: =49
        Size: =21
        TrueFill: =Color.Black
        TrueText: ="Yes"
        Width: =154
        X: =445
        Y: =393
        ZIndex: =12

    Label_GetEmail As label:
        Height: =70
        Size: =21
        Text: ="Email?"
        Width: =113
        X: =332
        Y: =382
        ZIndex: =13

    Label_validEmail As label:
        Color: =Color.Red
        Height: =70
        Size: =21
        Text: ="* Please check your email"
        Visible: =If(Or(IsBlank(EmailAddress), If(And(!IsBlank(EmailAddress), !IsMatch(EmailAddress.Text,Match.Email)), false, true)), false, true)
        Width: =377
        X: =221
        Y: =243
        ZIndex: =14

    Group_popup As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =18

        PopupScreen As rectangle:
            Fill: =RGBA(169, 169, 169, .75)
            Height: =1136
            Visible: =Popup 
            Width: =640
            ZIndex: =15

        Label_thanks As label:
            Align: =Align.Center
            Color: =Color.White
            Fill: =Color.Black
            FontWeight: =FontWeight.Bold
            Height: =175
            Size: =36
            Text: ="Thanks for filling out the form!"
            Visible: =Popup 
            Width: =560
            X: =40
            Y: =278
            ZIndex: =16

        Button_close As button:
            Color: =Color.White
            Fill: =Color.Black
            Height: =70
            OnSelect: |-
                =UpdateContext({Popup: false})
            Size: =24
            Text: ="Close"
            Visible: =Popup 
            Width: =280
            X: =180
            Y: =628
            ZIndex: =17

